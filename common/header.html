<!-- add current user's nsfw preferences to body tag -->
<!-- update -->
<script type="" version="0.8">
  // text/discourse-plugin
  // https://meta.discourse.org/t/css-classes-for-group-membership-for-simplified-ui-mode/60838/2
  if (window.jQuery) {
    window.jQuery(function ($) {
      const u = Discourse.User.current();
      const uGroups = u.groups;
      const hasR18Group = uGroups.find((value) => {
        const r18showedId = 53;
        return value["id"] === r18showedId ? true : false;
      });
      // always show NSFW
      if (hasR18Group !== undefined) {
        console.log("show nsfw for user");
        $("body").addClass("nsfw-always-show");
      }
    });

    // 禁用点击
    window.bind("load", function () {
      console.log("add img protect");
      document.querySelectorAll(".lightbox").forEach((element) => {
        element.addEventListener(
          "click",
          function (event) {
            event.preventDefault();
          },
          false
        );
      });
    });
  }
</script>
