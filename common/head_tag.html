
<script type="text/discourse-plugin" version="0.8">
    api.onPageChange(function () {
      if($("a#sort-topic-order")[0]){
        const ascending="?ascending=true&order=created"
        const decending="?order=created"
        let a=$("a#sort-topic-order")[0];
        if(window.location.search.match("ascending")){
          a.href=decending;
          a.style="transform:rotate(180deg);"
        }else{
          a.href=ascending;
        }
      }
  });
</script>

<script type="text/discourse-plugin" version="0.10.0">
  const I18n = require("I18n").default;
  I18n.translations[I18n.locale].js.filters.topliked = { help: "Top Liked" };

  api.addNavigationBarItem({
    displayName: "按创建排序",
    name: "按创建排序",
    before: "top",
    href: "/?order=created",
    customFilter: category => {
      console.log(category);
      return category ;
    },
    forceActive: (category, args, router) => { 
        const queryParams = router.currentRoute.queryParams;
        console.log(router.currentRoute);
        return (
          queryParams &&
          Object.keys(queryParams).length === 1 &&
          queryParams["order"] === "created"
        );
    }
  });
</script>
<script type="text/discourse-plugin" version="0.8">

    function replaceFontWarning (text) {
        while (text !== (text = text.replace(/\[warning=([^\]]+)\]((?:(?!\[warning=[^\]]+\]|\[\/warning\])[\S\s])*)\[\/warning\]/ig, function (match, p1, p2) {
          return `<div class="warning-among-text" color='${p1}'>${p2}</font>`;
        })));
        return text;
      }
      
   // api.onPageChange(function () {
     // if($(".cooked".length>0)){
       // console.log("init warning");
       // $.each($(".cooked"),(index,value)=>{value.innerText=replaceFontWarning(value.innerText)})
    //  }
 // });
</script>

<!-- <script type="text/discourse-plugin" version="0.8">
    api.modifyClass("route:user",{
        pluginId: "my-user-index",
        redirect: function() {
            console.log("haha");
            this.transitionTo("user.profile-hidden");

        },

    });
    
</script>
<script type="text/discourse-plugin" version="0.8">
    api.modifyClass("controller:topic", {
        pluginId: "my-filter-poster",
        firstPost: alias("topic.postStream.posts.0"),

        filterParticipant(post) {
            this.get("model.postStream")
              .filterParticipant(post.username)
              .then(() => this.updateQueryParams);
        },

    });
</script> -->



<script type="text/discourse-plugin" version="0.8">
    api.modifyClass("component:topic-notifications-button", {
        pluginId: "my-topic-notifications-button",
        appendReason: false,
        showFullTitle: false,
    });
</script>




